<script src="../../dist/vue.global.js"></script>

<div id="demo">
  <!-- <div class="currentBranchS">
    11111
  </div>
  <div @click="handleClick">
    {{currentBranch}}
  </div>
  <div v-for=" i in 5">
    {{i}}
  </div>
  <div @click="handleClick">
    {{double}}
  </div> -->
  <div @click="handle">
    点击切换
  </div>
  <div @click="handle1">
    点击切换1
  </div>
  <div v-if="falg">{{num}}</div>
  <div v-else>{{num1}}</div>
</div>

<script>
  const API_URL = `https://api.github.com/repos/vuejs/vue-next/commits?per_page=3&sha=`
  // const scope = Vue.effectScope()
  // debugger
  // const a = scope.run(() => {
  //   const doubled = Vue.computed(() => console.log(111))

  //   Vue.watch(doubled, () => console.log(22222))

  //   Vue.watchEffect(() => console.log('Count: ', 333333))
  //   return 111225
  // })
  // console.log(a)
  // 处理该作用域内的所有 effect
  // scope.stop()∫
  Vue.createApp({
    data: () => ({
      branches: ['master', 'sync'],
      currentBranch: 'master',
      commits: null
    }),
    setup() {
      const num = Vue.ref(1)
      const num1 = Vue.ref(2)
      const falg = Vue.ref(false)
      console.log(num)
      const double = Vue.computed(() => {
        console.log(1111)
        debugger
        return num.value * 2
      })
      function handleClick() {

        num.value++
      }
      function handle() {
        // debugger
        falg.value = false
      }
      function handle1() {
        falg.value = true
      }
      return {
        num,
        num1,
        falg,
        double,
        handle,
        handle1,
        handleClick
      }
    },
    // created() {
    //   this.fetchData()
    // },

    watch: {
      currentBranch: 'fetchData'
    },

    methods: {
      fetchData() {
        fetch(`${API_URL}${this.currentBranch}`)
          .then(res => res.json())
          .then(data => {
            this.commits = data
          })
      },
      truncate(v) {
        const newline = v.indexOf('\n')
        return newline > 0 ? v.slice(0, newline) : v
      },
      formatDate(v) {
        return v.replace(/T|Z/g, ' ')
      }
    }
  }).mount('#demo')

  // function ba() {
  //   return 2, 3
  // }
  // console.log(ba())


</script>

<style>
  #demo {
    font-family: 'Helvetica', Arial, sans-serif;
  }

  a {
    text-decoration: none;
    color: #f66;
  }

  li {
    line-height: 1.5em;
    margin-bottom: 20px;
  }

  .author,
  .date {
    font-weight: bold;
  }
</style>